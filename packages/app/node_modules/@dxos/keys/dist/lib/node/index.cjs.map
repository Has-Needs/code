{
  "version": 3,
  "sources": ["../../../../../../node_modules/.pnpm/base32-decode@1.0.0/node_modules/base32-decode/index.js", "../../../src/dxn.ts", "../../../src/object-id.ts", "../../../src/space-id.ts", "../../../../../../node_modules/.pnpm/to-data-view@2.0.0/node_modules/to-data-view/index.js", "../../../../../../node_modules/.pnpm/base32-encode@2.0.0/node_modules/base32-encode/index.js", "../../../src/random-bytes.ts", "../../../src/identity-did.ts", "../../../src/public-key.ts"],
  "sourcesContent": ["var RFC4648 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'\nvar RFC4648_HEX = '0123456789ABCDEFGHIJKLMNOPQRSTUV'\nvar CROCKFORD = '0123456789ABCDEFGHJKMNPQRSTVWXYZ'\n\nfunction readChar (alphabet, char) {\n  var idx = alphabet.indexOf(char)\n\n  if (idx === -1) {\n    throw new Error('Invalid character found: ' + char)\n  }\n\n  return idx\n}\n\nmodule.exports = function base32Decode (input, variant) {\n  var alphabet\n\n  switch (variant) {\n    case 'RFC3548':\n    case 'RFC4648':\n      alphabet = RFC4648\n      input = input.replace(/=+$/, '')\n      break\n    case 'RFC4648-HEX':\n      alphabet = RFC4648_HEX\n      input = input.replace(/=+$/, '')\n      break\n    case 'Crockford':\n      alphabet = CROCKFORD\n      input = input.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')\n      break\n    default:\n      throw new Error('Unknown base32 variant: ' + variant)\n  }\n\n  var length = input.length\n\n  var bits = 0\n  var value = 0\n\n  var index = 0\n  var output = new Uint8Array((length * 5 / 8) | 0)\n\n  for (var i = 0; i < length; i++) {\n    value = (value << 5) | readChar(alphabet, input[i])\n    bits += 5\n\n    if (bits >= 8) {\n      output[index++] = (value >>> (bits - 8)) & 255\n      bits -= 8\n    }\n  }\n\n  return output.buffer\n}\n", "//\n// Copyright 2024 DXOS.org\n//\n\nimport { Schema } from 'effect';\nimport type { inspect, InspectOptionsStylized } from 'node:util';\n\nimport { devtoolsFormatter, type DevtoolsFormatter, inspectCustom } from '@dxos/debug';\nimport { invariant } from '@dxos/invariant';\n\nimport { ObjectId } from './object-id';\nimport { SpaceId } from './space-id';\n\n/**\n * Tags for ECHO DXNs that should resolve the object ID in the local space.\n */\n// TODO(dmaretskyi): Rebrand this as \"unknown location\" to specify objects in the same space or queue. Essentially making the DXN it a URI not URL\n// TODO(dmaretskyi): \"@\" is a separator character in the URI spec.\nexport const LOCAL_SPACE_TAG = '@';\n\n// TODO(burdon): Namespace for.\nexport const QueueSubspaceTags = Object.freeze({\n  DATA: 'data',\n  TRACE: 'trace',\n});\n\nexport type QueueSubspaceTag = (typeof QueueSubspaceTags)[keyof typeof QueueSubspaceTags];\n\n/**\n * DXN unambiguously names a resource like an ECHO object, schema definition, plugin, etc.\n * Each DXN starts with a dxn prefix, followed by a resource kind.\n * Colon Symbol : is used a delimiter between parts.\n * DXNs may contain slashes.\n * '@' in the place of the space id is used to denote that the DXN should be resolved in the local space.\n *\n * @example\n * ```\n * dxn:echo:<space key>:<echo id>\n * dxn:echo:BA25QRC2FEWCSAMRP4RZL65LWJ7352CKE:01J00J9B45YHYSGZQTQMSKMGJ6\n * dxn:echo:@:01J00J9B45YHYSGZQTQMSKMGJ6\n * dxn:type:dxos.org/type/Calendar\n * dxn:plugin:dxos.org/agent/plugin/functions\n * ```\n */\nexport class DXN {\n  // TODO(dmaretskyi): Should this be a transformation into the DXN type?\n  static Schema = Schema.NonEmptyString.pipe(\n    Schema.pattern(/^dxn:([^:]+):(?:[^:]+:?)+[^:]$/),\n    // TODO(dmaretskyi): To set the format we need to move the annotation IDs out of the echo-schema package.\n    // FormatAnnotation.set(FormatEnum.DXN),\n    Schema.annotations({\n      title: 'DXN',\n      description: 'DXN URI',\n      examples: ['dxn:type:example.com/type/MyType', 'dxn:echo:@:01J00J9B45YHYSGZQTQMSKMGJ6'],\n    }),\n  );\n\n  static hash(dxn: DXN): string {\n    return dxn.toString();\n  }\n\n  /**\n   * Kind constants.\n   */\n  static kind = Object.freeze({\n    /**\n     * dxn:type:<type name>[:<version>]\n     */\n    TYPE: 'type',\n\n    /**\n     * dxn:echo:<space id>:<echo id>\n     * dxn:echo:@:<echo id>\n     */\n    // TODO(burdon): Rename to OBJECT? (BREAKING CHANGE).\n    // TODO(burdon): Add separate Kind for space.\n    ECHO: 'echo',\n\n    /**\n     * The subspace tag enables us to partition queues by usage within the context of a space.\n     * dxn:queue:<subspace_tag>:<space_id>:<queue_id>[:object_id]\n     * dxn:queue:data:BA25QRC2FEWCSAMRP4RZL65LWJ7352CKE:01J00J9B45YHYSGZQTQMSKMGJ6\n     * dxn:queue:trace:BA25QRC2FEWCSAMRP4RZL65LWJ7352CKE:01J00J9B45YHYSGZQTQMSKMGJ6\n     */\n    QUEUE: 'queue',\n  });\n\n  get kind() {\n    return this.#kind;\n  }\n\n  static equals(a: DXN, b: DXN): boolean {\n    return a.kind === b.kind && a.parts.length === b.parts.length && a.parts.every((part, i) => part === b.parts[i]);\n  }\n\n  // TODO(burdon): Rename isValid.\n  static isDXNString(dxn: string): boolean {\n    return dxn.startsWith('dxn:');\n  }\n\n  static parse(dxn: string): DXN {\n    if (typeof dxn !== 'string') {\n      throw new Error(`Invalid DXN: ${dxn}`);\n    }\n    const [prefix, kind, ...parts] = dxn.split(':');\n    if (!(prefix === 'dxn')) {\n      throw new Error(`Invalid DXN: ${dxn}`);\n    }\n    if (!(typeof kind === 'string' && kind.length > 0)) {\n      throw new Error(`Invalid DXN: ${dxn}`);\n    }\n    if (!(parts.length > 0)) {\n      throw new Error(`Invalid DXN: ${dxn}`);\n    }\n\n    return new DXN(kind, parts);\n  }\n\n  static tryParse(dxn: string): DXN | undefined {\n    try {\n      return DXN.parse(dxn);\n    } catch (error) {\n      return undefined;\n    }\n  }\n\n  /**\n   * @example `dxn:type:example.com/type/Contact`\n   */\n  static fromTypename(typename: string): DXN {\n    return new DXN(DXN.kind.TYPE, [typename]);\n  }\n\n  /**\n   * @example `dxn:type:example.com/type/Contact:0.1.0`\n   */\n  // TODO(dmaretskyi): Consider using @ as the version separator.\n  static fromTypenameAndVersion(typename: string, version: string): DXN {\n    return new DXN(DXN.kind.TYPE, [typename, version]);\n  }\n\n  /**\n   * @example `dxn:echo:@:01J00J9B45YHYSGZQTQMSKMGJ6`\n   */\n  static fromLocalObjectId(id: string): DXN {\n    return new DXN(DXN.kind.ECHO, [LOCAL_SPACE_TAG, id]);\n  }\n\n  static fromQueue(subspaceTag: QueueSubspaceTag, spaceId: SpaceId, queueId: ObjectId, objectId?: ObjectId) {\n    invariant(SpaceId.isValid(spaceId));\n    invariant(ObjectId.isValid(queueId));\n    invariant(!objectId || ObjectId.isValid(objectId));\n\n    return new DXN(DXN.kind.QUEUE, [subspaceTag, spaceId, queueId, ...(objectId ? [objectId] : [])]);\n  }\n\n  #kind: string;\n  #parts: string[];\n\n  constructor(kind: string, parts: string[]) {\n    invariant(parts.length > 0);\n    invariant(parts.every((part) => typeof part === 'string' && part.length > 0 && part.indexOf(':') === -1));\n\n    // Per-type validation.\n    switch (kind) {\n      case DXN.kind.TYPE:\n        if (parts.length > 2) {\n          throw new Error('Invalid \"type\" DXN');\n        }\n        break;\n      case DXN.kind.ECHO:\n        if (parts.length !== 2) {\n          throw new Error('Invalid \"echo\" DXN');\n        }\n        break;\n    }\n\n    this.#kind = kind;\n    this.#parts = parts;\n  }\n\n  get parts() {\n    return this.#parts;\n  }\n\n  // TODO(burdon): Should getters fail?\n  get typename() {\n    invariant(this.#kind === DXN.kind.TYPE);\n    return this.#parts[0];\n  }\n\n  hasTypenameOf(typename: string): boolean {\n    return this.#kind === DXN.kind.TYPE && this.#parts.length === 1 && this.#parts[0] === typename;\n  }\n\n  isLocalObjectId(): boolean {\n    return this.#kind === DXN.kind.ECHO && this.#parts[0] === LOCAL_SPACE_TAG && this.#parts.length === 2;\n  }\n\n  asTypeDXN(): DXN.TypeDXN | undefined {\n    if (this.kind !== DXN.kind.TYPE) {\n      return undefined;\n    }\n\n    const [type, version] = this.#parts;\n    return {\n      type,\n      version: version as string | undefined,\n    };\n  }\n\n  asEchoDXN(): DXN.EchoDXN | undefined {\n    if (this.kind !== DXN.kind.ECHO) {\n      return undefined;\n    }\n\n    const [spaceId, echoId] = this.#parts;\n    return {\n      spaceId: spaceId === LOCAL_SPACE_TAG ? undefined : (spaceId as SpaceId | undefined),\n      echoId,\n    };\n  }\n\n  asQueueDXN(): DXN.QueueDXN | undefined {\n    if (this.kind !== DXN.kind.QUEUE) {\n      return undefined;\n    }\n\n    const [subspaceTag, spaceId, queueId, objectId] = this.#parts;\n    if (typeof queueId !== 'string') {\n      return undefined;\n    }\n\n    return {\n      subspaceTag,\n      spaceId: spaceId as SpaceId,\n      queueId,\n      objectId: objectId as string | undefined,\n    };\n  }\n\n  toString(): DXN.String {\n    return `dxn:${this.#kind}:${this.#parts.join(':')}` as DXN.String;\n  }\n\n  /**\n   * Used by Node.js to get textual representation of this object when it's printed with a `console.log` statement.\n   */\n  [inspectCustom](depth: number, options: InspectOptionsStylized, inspectFn: typeof inspect): string {\n    const printControlCode = (code: number) => {\n      return `\\x1b[${code}m`;\n    };\n\n    return (\n      printControlCode(inspectFn.colors.blueBright![0]) + this.toString() + printControlCode(inspectFn.colors.reset![0])\n    );\n  }\n\n  get [devtoolsFormatter](): DevtoolsFormatter {\n    return {\n      header: () => {\n        return ['span', { style: 'font-weight: bold;' }, this.toString()];\n      },\n    };\n  }\n}\n\n// TODO(dmaretskyi): Fluent API:\n/*\nclass DXN {\n  ...\nisEchoDXN(): this is EchoDXN {\n  return this.#kind === DXN.kind.ECHO;\n}\n...\n}\n\ninterface EchoDXN extends DXN {\n  objectId: ObjectId;\n}\n\ndeclare const dxn: DXN;\n\ndxn.objectId\n\nif(dxn.isEchoDXN()) {\n  dxn.objectId\n}\n  ```\n\n/**\n * API namespace.\n */\nexport declare namespace DXN {\n  export type TypeDXN = {\n    type: string;\n    version?: string;\n  };\n\n  export type EchoDXN = {\n    spaceId?: SpaceId;\n    // TODO(burdon): Rename objectId.\n    echoId: string; // TODO(dmaretskyi): ObjectId.\n  };\n\n  export type QueueDXN = {\n    subspaceTag: string;\n    spaceId: SpaceId;\n    queueId: string; // TODO(dmaretskyi): ObjectId.\n    objectId?: string; // TODO(dmaretskyi): ObjectId.\n  };\n\n  /**\n   * DXN represented as a javascript string.\n   */\n  export type String = string & { __DXNString: never };\n  // TODO(burdon): Make brand.\n  // export const String = S.String.pipe(S.brand('DXN'));\n  // export type String = S.To(typoeof String);\n}\n", "//\n// Copyright 2025 DXOS.org\n//\n\nimport { Schema } from 'effect';\nimport { ulid } from 'ulidx';\n\n// TODO(dmaretskyi): Make brand.\n// export const ObjectIdBrand: unique symbol = Symbol('@dxos/echo/ObjectId');\n// export const ObjectIdSchema = Schema.ULID.pipe(S.brand(ObjectIdBrand));\nconst ObjectIdSchema = Schema.String.pipe(Schema.pattern(/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i)).annotations({\n  description: 'a Universally Unique Lexicographically Sortable Identifier',\n  pattern: '^[0-7][0-9A-HJKMNP-TV-Z]{25}$',\n});\n\nexport type ObjectId = typeof ObjectIdSchema.Type;\n\nexport interface ObjectIdClass extends Schema.SchemaClass<ObjectId, string> {\n  isValid(id: string): id is ObjectId;\n  make(id: string): ObjectId;\n  random(): ObjectId;\n}\n\n/**\n * Randomly generated unique identifier for an object.\n *\n * Follows ULID spec.\n */\nexport const ObjectId: ObjectIdClass = class extends ObjectIdSchema {\n  static isValid(id: string): id is ObjectId {\n    try {\n      Schema.decodeSync(ObjectId)(id);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }\n\n  static random(): ObjectId {\n    return ulid() as ObjectId;\n  }\n};\n", "//\n// Copyright 2024 DXOS.org\n//\n\nimport base32Decode from 'base32-decode';\nimport base32Encode from 'base32-encode';\nimport { Schema } from 'effect';\n\nimport { invariant } from '@dxos/invariant';\n\nimport { randomBytes } from './random-bytes';\n\n/**\n * Denotes RFC4648 base-32 format.\n */\nconst MULTIBASE_PREFIX = 'B';\n\nconst ENCODED_LENGTH = 33;\n\nconst isValid = (value: string): value is SpaceId => {\n  return typeof value === 'string' && value.startsWith(MULTIBASE_PREFIX) && value.length === ENCODED_LENGTH;\n};\n\n/**\n * A unique identifier for a space.\n * Space keys are generated by creating a keypair, and then taking the first 20 bytes of the SHA-256 hash of the public key and encoding them to multibase RFC4648 base-32 format (prefixed with B, see Multibase Table).\n * @example BA25QRC2FEWCSAMRP4RZL65LWJ7352CKE\n */\n// TODO(burdon): Use effect branded type?\nexport type SpaceId = string & { __SpaceId: true };\n\nexport const SpaceId: Schema.Schema<SpaceId, string> & {\n  byteLength: number;\n  encode: (value: Uint8Array) => SpaceId;\n  decode: (value: SpaceId) => Uint8Array;\n  isValid: (value: string) => value is SpaceId;\n  make: (value: string) => SpaceId;\n  random: () => SpaceId;\n} = class extends Schema.String.pipe(Schema.filter(isValid)) {\n  static byteLength = 20;\n\n  static encode = (value: Uint8Array): SpaceId => {\n    invariant(value instanceof Uint8Array, 'Invalid type');\n    invariant(value.length === SpaceId.byteLength, 'Invalid length');\n    return (MULTIBASE_PREFIX + base32Encode(value, 'RFC4648')) as SpaceId;\n  };\n\n  static decode = (value: SpaceId): Uint8Array => {\n    invariant(value.startsWith(MULTIBASE_PREFIX), 'Invalid multibase32 encoding');\n    return new Uint8Array(base32Decode(value.slice(1), 'RFC4648'));\n  };\n\n  static isValid = isValid;\n\n  static random = (): SpaceId => {\n    return SpaceId.encode(randomBytes(SpaceId.byteLength));\n  };\n};\n", "export default function toDataView (data) {\n  if (data instanceof Int8Array || data instanceof Uint8Array || data instanceof Uint8ClampedArray) {\n    return new DataView(data.buffer, data.byteOffset, data.byteLength)\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return new DataView(data)\n  }\n\n  throw new TypeError('Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray')\n}\n", "import toDataView from 'to-data-view'\n\nconst RFC4648 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'\nconst RFC4648_HEX = '0123456789ABCDEFGHIJKLMNOPQRSTUV'\nconst CROCKFORD = '0123456789ABCDEFGHJKMNPQRSTVWXYZ'\n\nexport default function base32Encode (data, variant, options) {\n  options = options || {}\n  let alphabet, defaultPadding\n\n  switch (variant) {\n    case 'RFC3548':\n    case 'RFC4648':\n      alphabet = RFC4648\n      defaultPadding = true\n      break\n    case 'RFC4648-HEX':\n      alphabet = RFC4648_HEX\n      defaultPadding = true\n      break\n    case 'Crockford':\n      alphabet = CROCKFORD\n      defaultPadding = false\n      break\n    default:\n      throw new Error('Unknown base32 variant: ' + variant)\n  }\n\n  const padding = (options.padding !== undefined ? options.padding : defaultPadding)\n  const view = toDataView(data)\n\n  let bits = 0\n  let value = 0\n  let output = ''\n\n  for (let i = 0; i < view.byteLength; i++) {\n    value = (value << 8) | view.getUint8(i)\n    bits += 8\n\n    while (bits >= 5) {\n      output += alphabet[(value >>> (bits - 5)) & 31]\n      bits -= 5\n    }\n  }\n\n  if (bits > 0) {\n    output += alphabet[(value << (5 - bits)) & 31]\n  }\n\n  if (padding) {\n    while ((output.length % 8) !== 0) {\n      output += '='\n    }\n  }\n\n  return output\n}\n", "//\n// Copyright 2024 DXOS.org\n//\n\nexport const randomBytes = (length: number) => {\n  // globalThis.crypto is not available in Node.js when running in vitest even though the documentation says it should be.\n  // eslint-disable-next-line @typescript-eslint/no-var-requires\n  const webCrypto = globalThis.crypto ?? require('node:crypto').webcrypto;\n\n  const bytes = new Uint8Array(length);\n  webCrypto.getRandomValues(bytes);\n  return bytes;\n};\n", "//\n// Copyright 2024 DXOS.org\n//\n\nimport base32Decode from 'base32-decode';\nimport base32Encode from 'base32-encode';\n\nimport { invariant } from '@dxos/invariant';\n\nimport { randomBytes } from './random-bytes';\n\n/**\n * A unique identifier for an identity.\n * Identity DIDs are generated by creating a keypair, and then taking the first 20 bytes of the SHA-256 hash of the public key and encoding them to multibase RFC4648 base-32 format (prefixed with B, see Multibase Table).\n * @example did:halo:BA25QRC2FEWCSAMRP4RZL65LWJ7352CKE\n */\nexport type IdentityDid = string & { __IdentityDid: never };\n\nexport const IdentityDid = Object.freeze({\n  byteLength: 20,\n  encode: (value: Uint8Array): IdentityDid => {\n    invariant(value instanceof Uint8Array, 'Invalid type');\n    invariant(value.length === IdentityDid.byteLength, 'Invalid length');\n\n    return (DID_PREFIX + MULTIBASE_PREFIX + base32Encode(value, 'RFC4648')) as IdentityDid;\n  },\n  decode: (value: IdentityDid): Uint8Array => {\n    invariant(value.startsWith(DID_PREFIX + MULTIBASE_PREFIX), 'Invalid multibase32 encoding');\n\n    return new Uint8Array(base32Decode(value.slice(10), 'RFC4648'));\n  },\n  isValid: (value: string): value is IdentityDid => {\n    return (\n      typeof value === 'string' && value.startsWith(DID_PREFIX + MULTIBASE_PREFIX) && value.length === ENCODED_LENGTH\n    );\n  },\n  random: (): IdentityDid => {\n    return IdentityDid.encode(randomBytes(IdentityDid.byteLength));\n  },\n});\n\n/**\n * Denotes RFC4648 base-32 format.\n */\nconst MULTIBASE_PREFIX = 'B';\n\nconst DID_PREFIX = 'did:halo:';\n\nconst ENCODED_LENGTH = 42;\n", "//\n// Copyright 2020 DXOS.org\n//\n\nimport base32Decode from 'base32-decode';\nimport base32Encode from 'base32-encode';\nimport { type inspect, type InspectOptionsStylized } from 'node:util';\n\nimport {\n  devtoolsFormatter,\n  type DevtoolsFormatter,\n  equalsSymbol,\n  type Equatable,\n  inspectCustom,\n  truncateKey,\n} from '@dxos/debug';\nimport { invariant } from '@dxos/invariant';\n\nimport { randomBytes } from './random-bytes';\n\nexport const PUBLIC_KEY_LENGTH = 32;\nexport const SECRET_KEY_LENGTH = 64;\n\n/**\n * All representations that can be converted to a PublicKey.\n */\nexport type PublicKeyLike = PublicKey | Buffer | Uint8Array | ArrayBuffer | string;\n\n/**\n * Vitest with JSDom causes instanceof ArrayBuffer check to fail\n */\nconst isLikeArrayBuffer = (value: any): value is ArrayBuffer =>\n  typeof value === 'object' && value !== null && Object.getPrototypeOf(value).constructor.name === 'ArrayBuffer';\n\n/**\n * The purpose of this class is to assure consistent use of keys throughout the project.\n * Keys should be maintained as buffers in objects and proto definitions, and converted to hex\n * strings as late as possible (eg, to log/display).\n */\nexport class PublicKey implements Equatable {\n  static ZERO = PublicKey.from('00'.repeat(PUBLIC_KEY_LENGTH));\n\n  /**\n   * Creates new instance of PublicKey automatically determining the input format.\n   * @param source A Buffer, or Uint8Array, or hex encoded string, or something with an `asUint8Array` method on it\n   * @returns PublicKey\n   */\n  static from(source: PublicKeyLike): PublicKey {\n    invariant(source);\n    if (source instanceof PublicKey) {\n      return source;\n    } else if (source instanceof Buffer) {\n      return new PublicKey(new Uint8Array(source.buffer, source.byteOffset, source.byteLength));\n    } else if (source instanceof Uint8Array) {\n      return new PublicKey(source);\n    } else if (source instanceof ArrayBuffer || isLikeArrayBuffer(source)) {\n      return new PublicKey(new Uint8Array(source));\n    } else if (typeof source === 'string') {\n      // TODO(burdon): Check length.\n      return PublicKey.fromHex(source);\n    } else if ((<any>source).asUint8Array) {\n      return new PublicKey((<any>source).asUint8Array());\n    } else {\n      throw new TypeError(`Unable to create PublicKey from ${source}`);\n    }\n  }\n\n  /**\n   * Same as `PublicKey.from` but does not throw and instead returns a `{ key: PublicKey }` or `{ error: Error }`\n   * @param source Same PublicKeyLike argument as for `PublicKey.from`\n   * @returns PublicKey\n   */\n  static safeFrom(source?: PublicKeyLike): PublicKey | undefined {\n    if (!source) {\n      return undefined;\n    }\n\n    try {\n      const key = PublicKey.from(source);\n      // TODO(wittjosiah): Space keys don't pass this check.\n      // if (key.length !== PUBLIC_KEY_LENGTH && key.length !== SECRET_KEY_LENGTH) {\n      //   return undefined;\n      // }\n      return key;\n    } catch (err: any) {\n      return undefined;\n    }\n  }\n\n  /**\n   * Creates new instance of PublicKey from hex string.\n   */\n  static fromHex(hex: string): PublicKey {\n    if (hex.startsWith('0x')) {\n      hex = hex.slice(2);\n    }\n\n    const buf = Buffer.from(hex, 'hex');\n    // TODO(burdon): Test if key.\n    return new PublicKey(new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength));\n  }\n\n  /**\n   * Creates a new key.\n   */\n  static random(): PublicKey {\n    // TODO(burdon): Enable seed for debugging.\n    return PublicKey.from(randomBytes(PUBLIC_KEY_LENGTH));\n  }\n\n  static randomOfLength(length: number): PublicKey {\n    return PublicKey.from(randomBytes(length));\n  }\n\n  static *randomSequence(): Generator<PublicKey> {\n    for (let i = 0; i < 1_0000; i++) {\n      // Counter just to protect against infinite loops.\n      yield PublicKey.random();\n    }\n    throw new Error('Too many keys requested');\n  }\n\n  /**\n   * Tests if provided values is an instance of PublicKey.\n   */\n  static isPublicKey(value: any): value is PublicKey {\n    return value instanceof PublicKey;\n  }\n\n  /**\n   * Asserts that provided values is an instance of PublicKey.\n   */\n  static assertValidPublicKey(value: any): asserts value is PublicKey {\n    if (!this.isPublicKey(value)) {\n      throw new TypeError('Invalid PublicKey');\n    }\n  }\n\n  /**\n   * Tests two keys for equality.\n   */\n  static equals(left: PublicKeyLike, right: PublicKeyLike): boolean {\n    return PublicKey.from(left).equals(right);\n  }\n\n  /**\n   * @param str string representation of key.\n   * @return Key buffer.\n   * @deprecated All keys should be represented as instances of PublicKey.\n   */\n  static bufferize(str: string): Buffer {\n    invariant(typeof str === 'string', 'Invalid type');\n    const buffer = Buffer.from(str, 'hex');\n    // invariant(buffer.length === PUBLIC_KEY_LENGTH || buffer.length === SECRET_KEY_LENGTH,\n    //   `Invalid key length: ${buffer.length}`);\n    return buffer;\n  }\n\n  /**\n   * @param key key like data structure (but not PublicKey which should use toString).\n   * @return Hex string representation of key.\n   * @deprecated All keys should be represented as instances of PublicKey.\n   */\n  static stringify(key: Buffer | Uint8Array | ArrayBuffer): string {\n    if (key instanceof PublicKey) {\n      key = key.asBuffer();\n    } else if (key instanceof Uint8Array) {\n      key = Buffer.from(key.buffer, key.byteOffset, key.byteLength);\n    }\n\n    invariant(key instanceof Buffer, 'Invalid type');\n    return key.toString('hex');\n  }\n\n  /**\n   * To be used with ComplexMap and ComplexSet.\n   * Returns a scalar representation for this key.\n   */\n  static hash(key: PublicKey): string {\n    return key.toHex();\n  }\n\n  static fromMultibase32(encoded: string): PublicKey {\n    invariant(encoded.startsWith('B'), 'Invalid multibase32 encoding');\n\n    return new PublicKey(new Uint8Array(base32Decode(encoded.slice(1), 'RFC4648')));\n  }\n\n  constructor(private readonly _value: Uint8Array) {\n    if (!(_value instanceof Uint8Array)) {\n      throw new TypeError(`Expected Uint8Array, got: ${_value}`);\n    }\n  }\n\n  toString(): string {\n    return this.toHex();\n  }\n\n  toJSON(): string {\n    return this.toHex();\n  }\n\n  toJSONL(): string {\n    return this.truncate();\n  }\n\n  get length() {\n    return this._value.length;\n  }\n\n  toHex(): string {\n    return this.asBuffer().toString('hex');\n  }\n\n  toMultibase32(): string {\n    return 'B' + base32Encode(this._value, 'RFC4648');\n  }\n\n  truncate(length = undefined): string {\n    return truncateKey(this, length);\n  }\n\n  asBuffer(): Buffer {\n    return Buffer.from(this._value.buffer, this._value.byteOffset, this._value.byteLength);\n  }\n\n  asUint8Array(): Uint8Array {\n    return this._value;\n  }\n\n  getInsecureHash(modulo: number): number {\n    return Math.abs(this._value.reduce((acc, val) => (acc ^ val) | 0, 0)) % modulo;\n  }\n\n  /**\n   * Used by Node.js to get textual representation of this object when it's printed with a `console.log` statement.\n   */\n  [inspectCustom](depth: number, options: InspectOptionsStylized, inspectFn: typeof inspect): string {\n    if (!options.colors || typeof process.stdout.hasColors !== 'function' || !process.stdout.hasColors()) {\n      return `<PublicKey ${this.truncate()}>`;\n    }\n\n    const printControlCode = (code: number) => {\n      return `\\x1b[${code}m`;\n    };\n\n    // NOTE: Keep in sync with formatter colors.\n    const colors = [\n      'red',\n      'green',\n      'yellow',\n      'blue',\n      'magenta',\n      'cyan',\n      'redBright',\n      'greenBright',\n      'yellowBright',\n      'blueBright',\n      'magentaBright',\n      'cyanBright',\n      'whiteBright',\n    ];\n    const color = colors[this.getInsecureHash(colors.length)];\n\n    return `PublicKey(${printControlCode(inspectFn.colors[color]![0])}${this.truncate()}${printControlCode(\n      inspectFn.colors.reset![0],\n    )})`;\n  }\n\n  get [devtoolsFormatter](): DevtoolsFormatter {\n    return {\n      header: () => {\n        // NOTE: Keep in sync with inspect colors.\n        const colors = [\n          'darkred',\n          'green',\n          'orange',\n          'blue',\n          'darkmagenta',\n          'darkcyan',\n          'red',\n          'green',\n          'orange',\n          'blue',\n          'magenta',\n          'darkcyan',\n          'black',\n        ];\n        const color = colors[this.getInsecureHash(colors.length)];\n\n        return [\n          'span',\n          {},\n          ['span', {}, 'PublicKey('],\n          ['span', { style: `color: ${color};` }, this.truncate()],\n          ['span', {}, ')'],\n        ];\n      },\n    };\n  }\n\n  /**\n   * Test this key for equality with some other key.\n   */\n  equals(other: PublicKeyLike): boolean {\n    const otherConverted = PublicKey.from(other);\n    if (this._value.length !== otherConverted._value.length) {\n      return false;\n    }\n\n    let equal = true;\n    for (let i = 0; i < this._value.length; i++) {\n      equal &&= this._value[i] === otherConverted._value[i];\n    }\n\n    return equal;\n  }\n\n  [equalsSymbol](other: any): boolean {\n    if (!PublicKey.isPublicKey(other)) {\n      return false;\n    }\n\n    return this.equals(other);\n  }\n}\n"],
  "mappings": "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",
  "names": ["import_effect", "import_invariant", "import_debug", "exports", "module", "RFC4648", "RFC4648_HEX", "CROCKFORD", "base32Decode", "ObjectIdSchema", "Schema", "String", "pipe", "pattern", "annotations", "description", "ObjectId", "isValid", "id", "decodeSync", "err", "random", "ulid", "randomBytes", "length", "webCrypto", "globalThis", "crypto", "require", "webcrypto", "bytes", "Uint8Array", "getRandomValues", "MULTIBASE_PREFIX", "ENCODED_LENGTH", "value", "startsWith", "SpaceId", "filter", "byteLength", "encode", "invariant", "base32Encode", "decode", "slice", "LOCAL_SPACE_TAG", "QueueSubspaceTags", "Object", "freeze", "DATA", "TRACE", "DXN", "NonEmptyString", "title", "examples", "hash", "dxn", "toString", "kind", "TYPE", "ECHO", "QUEUE", "equals", "a", "b", "parts", "every", "part", "i", "isDXNString", "parse", "Error", "prefix", "split", "tryParse", "error", "undefined", "fromTypename", "typename", "fromTypenameAndVersion", "version", "fromLocalObjectId", "fromQueue", "subspaceTag", "spaceId", "queueId", "objectId", "indexOf", "hasTypenameOf", "isLocalObjectId", "asTypeDXN", "type", "asEchoDXN", "echoId", "asQueueDXN", "join", "inspectCustom", "depth", "options", "inspectFn", "printControlCode", "code", "colors", "blueBright", "reset", "devtoolsFormatter", "header", "style", "import_base32_decode", "IdentityDid", "DID_PREFIX", "PUBLIC_KEY_LENGTH", "SECRET_KEY_LENGTH", "isLikeArrayBuffer", "getPrototypeOf", "name", "PublicKey", "ZERO", "from", "repeat", "source", "Buffer", "buffer", "byteOffset", "ArrayBuffer", "fromHex", "asUint8Array", "TypeError", "safeFrom", "key", "hex", "buf", "randomOfLength", "randomSequence", "isPublicKey", "assertValidPublicKey", "left", "right", "bufferize", "str", "stringify", "asBuffer", "toHex", "fromMultibase32", "encoded", "_value", "toJSON", "toJSONL", "truncate", "toMultibase32", "truncateKey", "getInsecureHash", "modulo", "Math", "abs", "reduce", "acc", "val", "process", "stdout", "hasColors", "color", "other", "otherConverted", "equal", "equalsSymbol"]
}
