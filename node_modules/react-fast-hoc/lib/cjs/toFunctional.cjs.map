{"version":3,"file":"toFunctional.cjs","sources":["../../src/toFunctional.ts"],"sourcesContent":["import type { ComponentType } from \"react\";\nimport { Component as ReactComponent, createElement, forwardRef } from \"react\";\nimport { getComponentName } from \"./shared\";\n\nexport const FC_STORE = new WeakMap<object, Function>();\n\nexport type Get<TObject, IName> = IName extends keyof TObject\n  ? TObject[IName]\n  : unknown;\n\nconst _toFunctional = <Props>(Component: ComponentType<Props>) => {\n  if (!isClassComponent(Component)) {\n    FC_STORE.set(Component, Component);\n    return Component;\n  }\n\n  const FunctionalWrapper = forwardRef<Get<Props, \"ref\">, Props>((props, ref) =>\n    createElement(\n      Component as any,\n      {\n        ...props,\n        ref,\n      },\n      (props as { children: null | JSX.Element })?.children\n    )\n  );\n\n  FC_STORE.set(Component, FunctionalWrapper);\n  FC_STORE.set(FunctionalWrapper, FunctionalWrapper);\n\n  if (process.env.NODE_ENV === \"production\") {\n    return FunctionalWrapper;\n  }\n\n  const name = `${getComponentName(Component)}.FunctionalWrapper`;\n  FunctionalWrapper.displayName = name;\n  return FunctionalWrapper;\n};\n\nexport const toFunctional = <Props>(Component: ComponentType<Props>) =>\n  (FC_STORE.get(Component) as ReturnType<typeof _toFunctional<Props>>) ||\n  _toFunctional(Component);\n\nconst isPrototypeOf = Function.call.bind(Object.prototype.isPrototypeOf) as (\n  parent: unknown,\n  child: unknown\n) => boolean;\n\nexport const isClassComponent = isPrototypeOf.bind(\n  isPrototypeOf,\n  ReactComponent\n) as <T>(\n  Component: T\n) => Component is Extract<T, React.ComponentClass<any, any>>;\n"],"names":["forwardRef","createElement","getComponentName","ReactComponent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAIa,MAAA,QAAA,uBAAe,OAA0B,GAAA;AAMtD,MAAM,aAAA,GAAgB,CAAQ,SAAoC,KAAA;AAChE,EAAI,IAAA,CAAC,gBAAiB,CAAA,SAAS,CAAG,EAAA;AAChC,IAAS,QAAA,CAAA,GAAA,CAAI,WAAW,SAAS,CAAA,CAAA;AACjC,IAAO,OAAA,SAAA,CAAA;AAAA,GACT;AAEA,EAAA,MAAM,iBAAoB,GAAAA,gBAAA;AAAA,IAAqC,CAAC,OAAO,GACrE,KAAAC,mBAAA;AAAA,MACE,SAAA;AAAA,MACA,iCACK,KADL,CAAA,EAAA;AAAA,QAEE,GAAA;AAAA,OACF,CAAA;AAAA,MACC,KAA4C,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,KAAA,CAAA,QAAA;AAAA,KAC/C;AAAA,GACF,CAAA;AAEA,EAAS,QAAA,CAAA,GAAA,CAAI,WAAW,iBAAiB,CAAA,CAAA;AACzC,EAAS,QAAA,CAAA,GAAA,CAAI,mBAAmB,iBAAiB,CAAA,CAAA;AAEjD,EAAI,IAAA,OAAA,CAAQ,GAAI,CAAA,QAAA,KAAa,YAAc,EAAA;AACzC,IAAO,OAAA,iBAAA,CAAA;AAAA,GACT;AAEA,EAAM,MAAA,IAAA,GAAO,CAAG,EAAAC,uBAAA,CAAiB,SAAS,CAAA,CAAA,kBAAA,CAAA,CAAA;AAC1C,EAAA,iBAAA,CAAkB,WAAc,GAAA,IAAA,CAAA;AAChC,EAAO,OAAA,iBAAA,CAAA;AACT,CAAA,CAAA;AAEa,MAAA,YAAA,GAAe,CAAQ,SACjC,KAAA,QAAA,CAAS,IAAI,SAAS,CAAA,IACvB,cAAc,SAAS,EAAA;AAEzB,MAAM,gBAAgB,QAAS,CAAA,IAAA,CAAK,IAAK,CAAA,MAAA,CAAO,UAAU,aAAa,CAAA,CAAA;AAKhE,MAAM,mBAAmB,aAAc,CAAA,IAAA;AAAA,EAC5C,aAAA;AAAA,EACAC,eAAA;AACF;;;;;;"}